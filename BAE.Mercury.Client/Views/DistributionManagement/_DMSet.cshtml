@using System.Diagnostics;
@using BAE.Mercury.Client.Models;
@model BAE.Mercury.Client.Models.DMset

<!--set start  -->

<div class="set" >
@{ if (Model.Children.Count > 0) {
    foreach (DMunit unit in Model.Children){
    <!--unit start -->
        <div class="unit">
            <div class="unit-title">@Html.Raw(unit.Name)</div>
            <div class="user rounded">Duty Officer = Watchkeeper</div>
            @{ 
                if (unit.Children.Count > 0) {
                <div class="canvas">
                    @{foreach (DMappointment appointment in unit.Children)  {
                        <table class="appointment" style="margin-top:20px;">
                            <tbody>
                                <tr>
                                    <td class="appointment">
                                        <div class="appointment">@Html.Raw(appointment.Name)</div>
                                    </td>
                                    <td class="sic-table">

                                        <div id="dw_@Html.Raw(String.Format("{0}_{1}_{2}", Model.Id, unit.Id, appointment.Id))">
                                            @{ 
                                    
                                                Debug.WriteLine(appointment.Name);
                                                string setUnitId = String.Format("{0}_{1}", Model.Id, unit.Id);
                                                Html.RenderPartial("_DMTable", appointment);

                                            }
                                    

                                        </div>
                                    </td>
                                    <td class="add"> 
                                    @if (!(((DMset)appointment.Parent.Parent).Locked || ((DMunit)appointment.Parent).Locked)) {
                                                                         
                                        <a id="aa_@Html.Raw(String.Format("{0}_{1}_{2}", Model.Id, unit.Id, appointment.Id))" href="#">
                                            <img src="~/images/icon-plus.png" alt="plus"/></a>
                                    } 
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    <br /> @*break between appointments*@
                      }}
                </div>
                }
                else
                {
                    <div class="no-app">No Appointments</div>
                    <br />@*break between appointments*@

                }
                
            } 
        </div>
        <p style="line-height:1px;"/> @*break between appointments*@
    <!--unit end -->
    }
   }
   else
   {
       <div style="background-color:white; margin:auto; text-align:center">No Units</div>
   }
   
 }

</div>
<!--set end-->
